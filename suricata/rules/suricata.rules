# Suricata rules file - add rules here
# DNS Query Detection
alert dns any any -> any any (msg:"DNS Query Detected"; flow:to_server; threshold: type limit, track by_src, count 1, seconds 60; sid:1000001; rev:1;)

# HTTP Traffic Detection  
alert http any any -> any any (msg:"HTTP Request Detected"; flow:established,to_server; http.method; content:"GET"; threshold: type limit, track by_src, count 1, seconds 60; sid:1000002; rev:1;)
alert http any any -> any any (msg:"HTTP POST Request"; flow:established,to_server; http.method; content:"POST"; threshold: type limit, track by_src, count 1, seconds 60; sid:1000003; rev:1;)

# TLS/SSL Detection
alert tls any any -> any any (msg:"TLS/SSL Connection Detected"; flow:established; threshold: type limit, track by_src, count 1, seconds 60; sid:1000004; rev:1;)

# SSH Detection
alert ssh any any -> any 22 (msg:"SSH Connection Attempt"; flow:to_server,established; threshold: type limit, track by_src, count 1, seconds 300; sid:1000005; rev:1;)

# MQTT Detection (for IoT monitoring)
alert tcp any any -> any 1883 (msg:"MQTT Connection Detected"; flow:to_server,established; threshold: type limit, track by_src, count 1, seconds 300; sid:1000006; rev:1;)

# Port Scan Detection
alert tcp any any -> $HOME_NET any (msg:"Possible Port Scan"; flags:S; threshold: type threshold, track by_src, count 20, seconds 60; sid:1000010; rev:1;)

# ICMP Ping Detection
alert icmp any any -> any any (msg:"ICMP Ping Detected"; itype:8; threshold: type limit, track by_src, count 1, seconds 60; sid:1000011; rev:1;)

# Suspicious Outbound Traffic
alert tcp $HOME_NET any -> $EXTERNAL_NET [80,443,8080,8443] (msg:"Outbound HTTP/HTTPS Traffic"; flow:to_server,established; threshold: type limit, track by_src, count 1, seconds 120; sid:1000020; rev:1;)

# File Transfer Detection
alert tcp any any -> any 21 (msg:"FTP Connection"; flow:to_server,established; threshold: type limit, track by_src, count 1, seconds 300; sid:1000030; rev:1;)

# SMB/Windows Shares
alert tcp any any -> any 445 (msg:"SMB Connection Detected"; flow:to_server,established; threshold: type limit, track by_src, count 1, seconds 300; sid:1000031; rev:1;)

# DHCP Detection
alert udp any 68 -> any 67 (msg:"DHCP Request Detected"; threshold: type limit, track by_src, count 1, seconds 300; sid:1000040; rev:1;)

# Generic Connection Tracking
alert tcp any any -> any any (msg:"TCP Connection Established"; flow:established,to_server; threshold: type limit, track by_src, count 1, seconds 60; sid:1000050; rev:1;)
alert udp any any -> any any (msg:"UDP Traffic Detected"; threshold: type limit, track by_src, count 1, seconds 60; sid:1000051; rev:1;)
